{% extends "base.html" %}
{% block title %}File Scanner - DefendersLab{% endblock %}

{% block content %}
<div class="container text-center mt-5">
  <h2 class="text-white mb-4">File Scanner</h2>
  <form method="POST" action="/scan" enctype="multipart/form-data" class="d-flex flex-column align-items-center">
    <input type="file" name="file" class="form-control mb-3" style="max-width: 400px;">
    <button type="submit" class="btn btn-outline-info">Scan File</button>
  </form>

  {% if result %}
    {% if result.status == "clean" %}
      <div class="mt-5 text-white bg-success bg-opacity-75 border border-success rounded p-4 text-center" style="max-width: 700px; margin: 0 auto;">
        <i class="bi bi-shield-check display-4 mb-3"></i>
        <h4 class="mb-3">File is Clean</h4>
        <pre class="text-start">{{ result.details }}</pre>
      </div>
    {% elif result.status == "infected" %}
      <div class="mt-5 text-white bg-danger bg-opacity-75 border border-danger rounded p-4 text-center" style="max-width: 700px; margin: 0 auto;">
        <i class="bi bi-bug-fill display-4 mb-3"></i>
        <h4 class="mb-3">Infected File Detected</h4>
        <pre class="text-start">{{ result.details }}</pre>
      </div>
    {% else %}
      <div class="mt-5 text-white bg-warning bg-opacity-75 border border-warning rounded p-4 text-center" style="max-width: 700px; margin: 0 auto;">
        <i class="bi bi-exclamation-triangle-fill display-4 mb-3"></i>
        <h4 class="mb-3">Scan Error</h4>
        <pre class="text-start">{{ result.details }}</pre>
      </div>
    {% endif %}
  {% endif %}
</div>
{% endblock %}
